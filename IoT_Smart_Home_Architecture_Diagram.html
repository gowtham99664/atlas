<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IoT Smart Home Dashboard - Detailed Architecture Diagram</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid #2196F3;
            padding-bottom: 20px;
        }
        .diagram-container {
            background: white;
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            margin: 20px 0;
        }
        .legend {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        .legend-item {
            display: inline-block;
            margin: 5px 15px;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        .layer-presentation { background: #E3F2FD; color: #1976D2; }
        .layer-service { background: #E8F5E8; color: #388E3C; }
        .layer-model { background: #FFF3E0; color: #F57C00; }
        .layer-data { background: #F5F5F5; color: #616161; }
        .external { background: #FFEBEE; color: #D32F2F; }
        .instructions {
            background: #E8F5E8;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #4CAF50;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🏠 IoT Smart Home Dashboard</h1>
            <h2>Detailed System Architecture</h2>
            <p><strong>Version:</strong> 1.0.0 | <strong>Technology:</strong> Java 11, Maven, DynamoDB Local</p>
        </div>

        <div class="instructions">
            <h3>📋 How to Import into Draw.io:</h3>
            <ol>
                <li>Go to <strong>https://app.diagrams.net/</strong></li>
                <li>Click <strong>"Create New Diagram"</strong></li>
                <li>Click <strong>"From Template"</strong> and search for "Mermaid"</li>
                <li>Or click <strong>"Arrange" → "Insert" → "Advanced" → "Mermaid"</strong></li>
                <li>Copy the Mermaid code below and paste it into Draw.io</li>
                <li>Customize colors, shapes, and layout as needed</li>
            </ol>
        </div>

        <div class="diagram-container">
            <h3>🎨 Mermaid Diagram Code for Draw.io:</h3>
            <textarea id="mermaid-code" rows="50" style="width: 100%; font-family: monospace; font-size: 12px; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
graph TB
    %% Define Styles
    classDef presentation fill:#E3F2FD,stroke:#1976D2,stroke-width:2px,color:#1976D2
    classDef service fill:#E8F5E8,stroke:#388E3C,stroke-width:2px,color:#388E3C
    classDef model fill:#FFF3E0,stroke:#F57C00,stroke-width:2px,color:#F57C00
    classDef data fill:#F5F5F5,stroke:#616161,stroke-width:2px,color:#616161
    classDef external fill:#FFEBEE,stroke:#D32F2F,stroke-width:2px,color:#D32F2F
    classDef core fill:#9C27B0,stroke:#7B1FA2,stroke-width:3px,color:white

    %% Presentation Layer
    subgraph PL["🖥️ PRESENTATION LAYER"]
        CLI[SmartHomeDashboard.java<br/>📋 18 Menu Options<br/>🔍 Input Validation<br/>🧭 Navigation System]
        SCAN[Scanner Input/Output<br/>⌨️ User Input<br/>📺 Display Output<br/>✅ Validation]
        NAV[Menu Navigation<br/>🔄 Flow Control<br/>📍 State Management<br/>🏠 Return to Menu]
    end

    %% Service Layer
    subgraph SL["⚙️ SERVICE LAYER"]
        %% Core Hub
        SHS[SmartHomeService<br/>🎛️ Central Orchestrator<br/>🔐 Session Management<br/>📊 Business Logic Hub<br/>🛡️ Security Enforcement]

        %% User Management
        CS[CustomerService<br/>👤 User Authentication<br/>🔐 BCrypt Password Hashing<br/>📝 Registration & Profile<br/>🔄 Password Reset]

        %% Device Management
        GS[GadgetService<br/>🏠 Device Operations<br/>⚡ Real-time Control<br/>📊 Status Monitoring<br/>🔧 CRUD Operations]

        %% Energy & Analytics
        EMS[EnergyManagementService<br/>⚡ Consumption Tracking<br/>💰 Cost Analysis<br/>📈 Usage Reports<br/>🎯 Efficiency Tips]

        %% Automation Services
        TS[TimerService<br/>⏰ Scheduling System<br/>🔄 Auto Execution<br/>⚙️ Cron-like Jobs<br/>💾 Persistence]

        SS[SmartScenesService<br/>🎬 8 Pre-configured Scenes<br/>✨ Custom Scenes<br/>🎭 Multi-device Control<br/>⚡ One-click Execution]

        %% Integration Services
        WS[WeatherService<br/>🌤️ Weather Data Fetching<br/>🤖 Smart Recommendations<br/>📋 Automation Rules<br/>🔮 5-Day Forecasting]

        CES[CalendarEventService<br/>📅 Event Management<br/>🤖 Context-aware Automation<br/>🔄 Integration Hub<br/>⚡ Trigger System]

        DHS[DeviceHealthService<br/>💊 Health Monitoring<br/>🔧 Maintenance Alerts<br/>📊 Performance Analytics<br/>📈 System Optimization]

        %% Utility Services
        SM[SessionManager<br/>🔐 Authentication State<br/>👤 User Context<br/>🛡️ Security Tokens<br/>⏱️ Timeout Management]
    end

    %% Model Layer
    subgraph ML["📋 MODEL LAYER"]
        CUST[Customer Entity<br/>👤 User Profile Data<br/>🔐 Encrypted Credentials<br/>👥 Group Relationships<br/>📊 Usage Statistics]

        GAD[Gadget Entity<br/>🏠 Device Information<br/>⚡ Power & Status Data<br/>⏱️ Usage Tracking<br/>💰 Energy Consumption]

        DP[DevicePermission Entity<br/>🔐 Access Control<br/>👥 User-Device Mapping<br/>🎭 Role Management<br/>📅 Grant Tracking]

        DER[DeletedDeviceEnergyRecord<br/>📊 Historical Energy Data<br/>💰 Billing Preservation<br/>🗂️ Archive Management<br/>📈 Cost Analysis]
    end

    %% Data Layer
    subgraph DL["💾 DATA LAYER"]
        DDB[DynamoDB Local<br/>🏠 Local NoSQL Database<br/>⚡ High Performance<br/>🔐 ACID Transactions<br/>📦 JSON Document Store]

        CT[Customer Table<br/>🔑 PK: email<br/>🆔 SK: customerId<br/>📊 GSI: groupId-index]

        GT[Gadget Table<br/>🔑 PK: customerId<br/>🆔 SK: deviceType+roomName<br/>📊 GSI: status-index]

        PT[DevicePermission Table<br/>🔑 PK: permissionId<br/>📊 GSI: ownerEmail-index<br/>📊 GSI: memberEmail-index]

        ET[DeletedEnergyRecord Table<br/>🔑 PK: originalOwner<br/>🆔 SK: deletionDate+recordId<br/>📊 GSI: monthly-billing-index]
    end

    %% External Systems
    subgraph EXT["🌐 EXTERNAL INTEGRATIONS"]
        WA[Weather API<br/>🌤️ Real-time Weather<br/>🌡️ Temperature & Humidity<br/>💨 Air Quality Index<br/>🔮 Forecasting Data]

        IOT[IoT Device Categories<br/>📺 Entertainment (TV, Speaker)<br/>🌡️ Climate (AC, Fan, Thermostat)<br/>💡 Lighting (Smart Bulbs, Switches)<br/>🔒 Security (Camera, Lock, Doorbell)<br/>🍳 Kitchen (Fridge, Microwave)<br/>🧹 Cleaning (Robot Vacuum)]

        UI[User Interface<br/>💻 Command Line Terminal<br/>⌨️ Keyboard Input<br/>🖥️ Cross-platform Display<br/>📱 Future: Mobile/Web]
    end

    %% Security Layer (Overlay)
    subgraph SEC["🔐 SECURITY ARCHITECTURE"]
        AUTH[Authentication Layer<br/>🔐 BCrypt Hashing (Cost: 12)<br/>📧 Email-based Identity<br/>🎫 Session Tokens<br/>🚫 Failed Login Protection]

        AUTHZ[Authorization Layer<br/>👑 Role-based Access Control<br/>🏠 Device-level Permissions<br/>👥 Group-based Sharing<br/>✅ Action-level Security]

        DATA_PROT[Data Protection Layer<br/>🔒 Local Database Encryption<br/>🏠 No Cloud Transmission<br/>✅ Input Sanitization<br/>🛡️ SQL Injection Prevention]
    end

    %% Connections - Presentation to Service
    CLI --> SHS
    SCAN --> SHS
    NAV --> SHS

    %% Core Service Hub Connections
    SHS --> CS
    SHS --> GS
    SHS --> EMS
    SHS --> TS
    SHS --> SS
    SHS --> WS
    SHS --> CES
    SHS --> DHS
    SHS --> SM

    %% Inter-Service Connections
    CS -.-> SM
    GS --> EMS
    TS --> GS
    SS --> GS
    WS -.-> SS
    CES --> GS

    %% Service to Model Connections
    CS --> CUST
    GS --> GAD
    EMS --> DER
    CS --> DP
    GS --> DP

    %% Model to Data Connections
    CUST --> CT
    GAD --> GT
    DP --> PT
    DER --> ET
    CT --> DDB
    GT --> DDB
    PT --> DDB
    ET --> DDB

    %% External Connections
    WS -.-> WA
    GS -.-> IOT
    CLI -.-> UI

    %% Security Connections
    CS --> AUTH
    SM --> AUTH
    DP --> AUTHZ
    CS --> AUTHZ
    CUST --> DATA_PROT
    GAD --> DATA_PROT

    %% Apply Styles
    class CLI,SCAN,NAV presentation
    class SHS core
    class CS,GS,EMS,TS,SS,WS,CES,DHS,SM service
    class CUST,GAD,DP,DER model
    class DDB,CT,GT,PT,ET data
    class WA,IOT,UI external
    class AUTH,AUTHZ,DATA_PROT external
            </textarea>

            <button onclick="copyToClipboard()" style="margin-top: 10px; padding: 10px 20px; background: #2196F3; color: white; border: none; border-radius: 4px; cursor: pointer;">
                📋 Copy Mermaid Code
            </button>
        </div>

        <div class="legend">
            <h3>🎨 Color Legend:</h3>
            <div class="legend-item layer-presentation">Presentation Layer</div>
            <div class="legend-item layer-service">Service Layer</div>
            <div class="legend-item layer-model">Model Layer</div>
            <div class="legend-item layer-data">Data Layer</div>
            <div class="legend-item external">External Systems</div>
        </div>

        <div style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 8px;">
            <h3>📊 Architecture Overview:</h3>
            <ul>
                <li><strong>4-Layer Architecture:</strong> Clean separation of presentation, business logic, data models, and storage</li>
                <li><strong>9 Core Services:</strong> Specialized services for different business domains</li>
                <li><strong>Central Orchestration:</strong> SmartHomeService acts as the main coordinator</li>
                <li><strong>Security First:</strong> Multiple security layers with encryption and access control</li>
                <li><strong>Scalable Design:</strong> Modular architecture supports future expansion</li>
                <li><strong>Local Data:</strong> Complete data sovereignty with no cloud dependencies</li>
                <li><strong>External Integration:</strong> Weather API and IoT device support</li>
                <li><strong>Performance Optimized:</strong> Efficient database design with proper indexing</li>
            </ul>
        </div>

        <div style="margin-top: 30px; padding: 20px; background: #e8f5e8; border-radius: 8px; border-left: 4px solid #4CAF50;">
            <h3>🚀 Key Technical Features:</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
                <div>
                    <h4>🏗️ Architecture:</h4>
                    <ul>
                        <li>Service-Oriented Architecture (SOA)</li>
                        <li>Dependency Injection Pattern</li>
                        <li>Singleton Pattern for Services</li>
                        <li>Observer Pattern for Events</li>
                    </ul>
                </div>
                <div>
                    <h4>🔧 Technologies:</h4>
                    <ul>
                        <li>Java 11 (LTS)</li>
                        <li>Apache Maven 3.11.0</li>
                        <li>AWS DynamoDB SDK 2.21.29</li>
                        <li>BCrypt Password Hashing</li>
                    </ul>
                </div>
                <div>
                    <h4>💾 Database:</h4>
                    <ul>
                        <li>DynamoDB Local (NoSQL)</li>
                        <li>4 Main Tables</li>
                        <li>GSI Indexes for Queries</li>
                        <li>ACID Compliance</li>
                    </ul>
                </div>
                <div>
                    <h4>🔐 Security:</h4>
                    <ul>
                        <li>BCrypt Encryption (Cost: 12)</li>
                        <li>Role-based Access Control</li>
                        <li>Local Data Storage</li>
                        <li>Input Validation</li>
                    </ul>
                </div>
            </div>
        </div>

        <div style="margin-top: 30px; text-align: center; color: #666; font-size: 14px;">
            <p>📅 Generated: September 14, 2025 | 🏠 IoT Smart Home Dashboard v1.0.0</p>
            <p>💻 Open this HTML file in any browser, then copy the Mermaid code into Draw.io</p>
        </div>
    </div>

    <script>
        function copyToClipboard() {
            const textarea = document.getElementById('mermaid-code');
            textarea.select();
            textarea.setSelectionRange(0, 99999); // For mobile devices

            try {
                document.execCommand('copy');
                alert('✅ Mermaid code copied to clipboard! Now paste it into Draw.io');
            } catch (err) {
                alert('❌ Failed to copy. Please select the text manually and copy with Ctrl+C');
            }
        }

        // Initialize Mermaid (optional, for preview)
        mermaid.initialize({ startOnLoad: false });
    </script>
</body>
</html>