graph TB
    %% IoT Smart Home Dashboard - System Architecture
    %% Copy this entire content and paste into Draw.io Mermaid import

    %% Define Styles
    classDef presentation fill:#E3F2FD,stroke:#1976D2,stroke-width:2px,color:#1976D2
    classDef service fill:#E8F5E8,stroke:#388E3C,stroke-width:2px,color:#388E3C
    classDef model fill:#FFF3E0,stroke:#F57C00,stroke-width:2px,color:#F57C00
    classDef data fill:#F5F5F5,stroke:#616161,stroke-width:2px,color:#616161
    classDef external fill:#FFEBEE,stroke:#D32F2F,stroke-width:2px,color:#D32F2F
    classDef core fill:#9C27B0,stroke:#7B1FA2,stroke-width:3px,color:white

    %% Presentation Layer
    subgraph PL["ğŸ–¥ï¸ PRESENTATION LAYER"]
        CLI[SmartHomeDashboard.java<br/>ğŸ“‹ 18 Menu Options<br/>ğŸ” Input Validation<br/>ğŸ§­ Navigation System]
        SCAN[Scanner Input/Output<br/>âŒ¨ï¸ User Input<br/>ğŸ“º Display Output<br/>âœ… Validation]
        NAV[Menu Navigation<br/>ğŸ”„ Flow Control<br/>ğŸ“ State Management<br/>ğŸ  Return to Menu]
    end

    %% Service Layer
    subgraph SL["âš™ï¸ SERVICE LAYER"]
        %% Core Hub
        SHS[SmartHomeService<br/>ğŸ›ï¸ Central Orchestrator<br/>ğŸ” Session Management<br/>ğŸ“Š Business Logic Hub<br/>ğŸ›¡ï¸ Security Enforcement]

        %% User Management
        CS[CustomerService<br/>ğŸ‘¤ User Authentication<br/>ğŸ” BCrypt Password Hashing<br/>ğŸ“ Registration & Profile<br/>ğŸ”„ Password Reset]

        %% Device Management
        GS[GadgetService<br/>ğŸ  Device Operations<br/>âš¡ Real-time Control<br/>ğŸ“Š Status Monitoring<br/>ğŸ”§ CRUD Operations]

        %% Energy & Analytics
        EMS[EnergyManagementService<br/>âš¡ Consumption Tracking<br/>ğŸ’° Cost Analysis<br/>ğŸ“ˆ Usage Reports<br/>ğŸ¯ Efficiency Tips]

        %% Automation Services
        TS[TimerService<br/>â° Scheduling System<br/>ğŸ”„ Auto Execution<br/>âš™ï¸ Cron-like Jobs<br/>ğŸ’¾ Persistence]

        SS[SmartScenesService<br/>ğŸ¬ 8 Pre-configured Scenes<br/>âœ¨ Custom Scenes<br/>ğŸ­ Multi-device Control<br/>âš¡ One-click Execution]

        %% Integration Services
        WS[WeatherService<br/>ğŸŒ¤ï¸ Weather Data Fetching<br/>ğŸ¤– Smart Recommendations<br/>ğŸ“‹ Automation Rules<br/>ğŸ”® 5-Day Forecasting]

        CES[CalendarEventService<br/>ğŸ“… Event Management<br/>ğŸ¤– Context-aware Automation<br/>ğŸ”„ Integration Hub<br/>âš¡ Trigger System]

        DHS[DeviceHealthService<br/>ğŸ’Š Health Monitoring<br/>ğŸ”§ Maintenance Alerts<br/>ğŸ“Š Performance Analytics<br/>ğŸ“ˆ System Optimization]

        %% Utility Services
        SM[SessionManager<br/>ğŸ” Authentication State<br/>ğŸ‘¤ User Context<br/>ğŸ›¡ï¸ Security Tokens<br/>â±ï¸ Timeout Management]
    end

    %% Model Layer
    subgraph ML["ğŸ“‹ MODEL LAYER"]
        CUST[Customer Entity<br/>ğŸ‘¤ User Profile Data<br/>ğŸ” Encrypted Credentials<br/>ğŸ‘¥ Group Relationships<br/>ğŸ“Š Usage Statistics]

        GAD[Gadget Entity<br/>ğŸ  Device Information<br/>âš¡ Power & Status Data<br/>â±ï¸ Usage Tracking<br/>ğŸ’° Energy Consumption]

        DP[DevicePermission Entity<br/>ğŸ” Access Control<br/>ğŸ‘¥ User-Device Mapping<br/>ğŸ­ Role Management<br/>ğŸ“… Grant Tracking]

        DER[DeletedDeviceEnergyRecord<br/>ğŸ“Š Historical Energy Data<br/>ğŸ’° Billing Preservation<br/>ğŸ—‚ï¸ Archive Management<br/>ğŸ“ˆ Cost Analysis]
    end

    %% Data Layer
    subgraph DL["ğŸ’¾ DATA LAYER"]
        DDB[DynamoDB Local<br/>ğŸ  Local NoSQL Database<br/>âš¡ High Performance<br/>ğŸ” ACID Transactions<br/>ğŸ“¦ JSON Document Store]

        CT[Customer Table<br/>ğŸ”‘ PK: email<br/>ğŸ†” SK: customerId<br/>ğŸ“Š GSI: groupId-index]

        GT[Gadget Table<br/>ğŸ”‘ PK: customerId<br/>ğŸ†” SK: deviceType+roomName<br/>ğŸ“Š GSI: status-index]

        PT[DevicePermission Table<br/>ğŸ”‘ PK: permissionId<br/>ğŸ“Š GSI: ownerEmail-index<br/>ğŸ“Š GSI: memberEmail-index]

        ET[DeletedEnergyRecord Table<br/>ğŸ”‘ PK: originalOwner<br/>ğŸ†” SK: deletionDate+recordId<br/>ğŸ“Š GSI: monthly-billing-index]
    end

    %% External Systems
    subgraph EXT["ğŸŒ EXTERNAL INTEGRATIONS"]
        WA[Weather API<br/>ğŸŒ¤ï¸ Real-time Weather<br/>ğŸŒ¡ï¸ Temperature & Humidity<br/>ğŸ’¨ Air Quality Index<br/>ğŸ”® Forecasting Data]

        IOT[IoT Device Categories<br/>ğŸ“º Entertainment: TV, Speaker<br/>ğŸŒ¡ï¸ Climate: AC, Fan, Thermostat<br/>ğŸ’¡ Lighting: Smart Bulbs, Switches<br/>ğŸ”’ Security: Camera, Lock, Doorbell<br/>ğŸ³ Kitchen: Fridge, Microwave<br/>ğŸ§¹ Cleaning: Robot Vacuum]

        UI[User Interface<br/>ğŸ’» Command Line Terminal<br/>âŒ¨ï¸ Keyboard Input<br/>ğŸ–¥ï¸ Cross-platform Display<br/>ğŸ“± Future: Mobile/Web]
    end

    %% Security Layer (Overlay)
    subgraph SEC["ğŸ” SECURITY ARCHITECTURE"]
        AUTH[Authentication Layer<br/>ğŸ” BCrypt Hashing Cost: 12<br/>ğŸ“§ Email-based Identity<br/>ğŸ« Session Tokens<br/>ğŸš« Failed Login Protection]

        AUTHZ[Authorization Layer<br/>ğŸ‘‘ Role-based Access Control<br/>ğŸ  Device-level Permissions<br/>ğŸ‘¥ Group-based Sharing<br/>âœ… Action-level Security]

        DATA_PROT[Data Protection Layer<br/>ğŸ”’ Local Database Encryption<br/>ğŸ  No Cloud Transmission<br/>âœ… Input Sanitization<br/>ğŸ›¡ï¸ SQL Injection Prevention]
    end

    %% Connections - Presentation to Service
    CLI --> SHS
    SCAN --> SHS
    NAV --> SHS

    %% Core Service Hub Connections
    SHS --> CS
    SHS --> GS
    SHS --> EMS
    SHS --> TS
    SHS --> SS
    SHS --> WS
    SHS --> CES
    SHS --> DHS
    SHS --> SM

    %% Inter-Service Connections
    CS -.-> SM
    GS --> EMS
    TS --> GS
    SS --> GS
    WS -.-> SS
    CES --> GS

    %% Service to Model Connections
    CS --> CUST
    GS --> GAD
    EMS --> DER
    CS --> DP
    GS --> DP

    %% Model to Data Connections
    CUST --> CT
    GAD --> GT
    DP --> PT
    DER --> ET
    CT --> DDB
    GT --> DDB
    PT --> DDB
    ET --> DDB

    %% External Connections
    WS -.-> WA
    GS -.-> IOT
    CLI -.-> UI

    %% Security Connections
    CS --> AUTH
    SM --> AUTH
    DP --> AUTHZ
    CS --> AUTHZ
    CUST --> DATA_PROT
    GAD --> DATA_PROT

    %% Apply Styles
    class CLI,SCAN,NAV presentation
    class SHS core
    class CS,GS,EMS,TS,SS,WS,CES,DHS,SM service
    class CUST,GAD,DP,DER model
    class DDB,CT,GT,PT,ET data
    class WA,IOT,UI external
    class AUTH,AUTHZ,DATA_PROT external